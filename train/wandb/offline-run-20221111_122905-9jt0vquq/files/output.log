/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/trainer/code/dataloading/dataloading.py:218: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  data_dict['ex_type'] = np.array(example_set_index)
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best)... Done. 0.3s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best)... Done. 0.3s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best)... Done. 0.1s
File /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/build_dataset/datasets/AA1_hotspots_seqlen=800_multnegs.h5 was successfully opened
File opened. Found the following Folds:
['test', 'train']
Fold folder opened. Found the following datasets:
['chr_10_neg_(1000, 5000)_meta', 'chr_10_neg_(1000, 5000)_seq', 'chr_10_neg_(10000, 20000)_meta', 'chr_10_neg_(10000, 20000)_seq', 'chr_10_neg_(20000, 100000)_meta', 'chr_10_neg_(20000, 100000)_seq', 'chr_10_neg_(5000, 10000)_meta', 'chr_10_neg_(5000, 10000)_seq', 'chr_10_pos_meta', 'chr_10_pos_out', 'chr_10_pos_seq', 'chr_11_neg_(1000, 5000)_meta', 'chr_11_neg_(1000, 5000)_seq', 'chr_11_neg_(10000, 20000)_meta', 'chr_11_neg_(10000, 20000)_seq', 'chr_11_neg_(20000, 100000)_meta', 'chr_11_neg_(20000, 100000)_seq', 'chr_11_neg_(5000, 10000)_meta', 'chr_11_neg_(5000, 10000)_seq', 'chr_11_pos_meta', 'chr_11_pos_out', 'chr_11_pos_seq', 'chr_12_neg_(1000, 5000)_meta', 'chr_12_neg_(1000, 5000)_seq', 'chr_12_neg_(10000, 20000)_meta', 'chr_12_neg_(10000, 20000)_seq', 'chr_12_neg_(20000, 100000)_meta', 'chr_12_neg_(20000, 100000)_seq', 'chr_12_neg_(5000, 10000)_meta', 'chr_12_neg_(5000, 10000)_seq', 'chr_12_pos_meta', 'chr_12_pos_out', 'chr_12_pos_seq', 'chr_13_neg_(1000, 5000)_meta', 'chr_13_neg_(1000, 5000)_seq', 'chr_13_neg_(10000, 20000)_meta', 'chr_13_neg_(10000, 20000)_seq', 'chr_13_neg_(20000, 100000)_meta', 'chr_13_neg_(20000, 100000)_seq', 'chr_13_neg_(5000, 10000)_meta', 'chr_13_neg_(5000, 10000)_seq', 'chr_13_pos_meta', 'chr_13_pos_out', 'chr_13_pos_seq', 'chr_14_neg_(1000, 5000)_meta', 'chr_14_neg_(1000, 5000)_seq', 'chr_14_neg_(10000, 20000)_meta', 'chr_14_neg_(10000, 20000)_seq', 'chr_14_neg_(20000, 100000)_meta', 'chr_14_neg_(20000, 100000)_seq', 'chr_14_neg_(5000, 10000)_meta', 'chr_14_neg_(5000, 10000)_seq', 'chr_14_pos_meta', 'chr_14_pos_out', 'chr_14_pos_seq', 'chr_15_neg_(1000, 5000)_meta', 'chr_15_neg_(1000, 5000)_seq', 'chr_15_neg_(10000, 20000)_meta', 'chr_15_neg_(10000, 20000)_seq', 'chr_15_neg_(20000, 100000)_meta', 'chr_15_neg_(20000, 100000)_seq', 'chr_15_neg_(5000, 10000)_meta', 'chr_15_neg_(5000, 10000)_seq', 'chr_15_pos_meta', 'chr_15_pos_out', 'chr_15_pos_seq', 'chr_16_neg_(1000, 5000)_meta', 'chr_16_neg_(1000, 5000)_seq', 'chr_16_neg_(10000, 20000)_meta', 'chr_16_neg_(10000, 20000)_seq', 'chr_16_neg_(20000, 100000)_meta', 'chr_16_neg_(20000, 100000)_seq', 'chr_16_neg_(5000, 10000)_meta', 'chr_16_neg_(5000, 10000)_seq', 'chr_16_pos_meta', 'chr_16_pos_out', 'chr_16_pos_seq', 'chr_17_neg_(1000, 5000)_meta', 'chr_17_neg_(1000, 5000)_seq', 'chr_17_neg_(10000, 20000)_meta', 'chr_17_neg_(10000, 20000)_seq', 'chr_17_neg_(20000, 100000)_meta', 'chr_17_neg_(20000, 100000)_seq', 'chr_17_neg_(5000, 10000)_meta', 'chr_17_neg_(5000, 10000)_seq', 'chr_17_pos_meta', 'chr_17_pos_out', 'chr_17_pos_seq', 'chr_18_neg_(1000, 5000)_meta', 'chr_18_neg_(1000, 5000)_seq', 'chr_18_neg_(10000, 20000)_meta', 'chr_18_neg_(10000, 20000)_seq', 'chr_18_neg_(20000, 100000)_meta', 'chr_18_neg_(20000, 100000)_seq', 'chr_18_neg_(5000, 10000)_meta', 'chr_18_neg_(5000, 10000)_seq', 'chr_18_pos_meta', 'chr_18_pos_out', 'chr_18_pos_seq', 'chr_19_neg_(1000, 5000)_meta', 'chr_19_neg_(1000, 5000)_seq', 'chr_19_neg_(10000, 20000)_meta', 'chr_19_neg_(10000, 20000)_seq', 'chr_19_neg_(20000, 100000)_meta', 'chr_19_neg_(20000, 100000)_seq', 'chr_19_neg_(5000, 10000)_meta', 'chr_19_neg_(5000, 10000)_seq', 'chr_19_pos_meta', 'chr_19_pos_out', 'chr_19_pos_seq', 'chr_1_neg_(1000, 5000)_meta', 'chr_1_neg_(1000, 5000)_seq', 'chr_1_neg_(10000, 20000)_meta', 'chr_1_neg_(10000, 20000)_seq', 'chr_1_neg_(20000, 100000)_meta', 'chr_1_neg_(20000, 100000)_seq', 'chr_1_neg_(5000, 10000)_meta', 'chr_1_neg_(5000, 10000)_seq', 'chr_1_pos_meta', 'chr_1_pos_out', 'chr_1_pos_seq', 'chr_20_neg_(1000, 5000)_meta', 'chr_20_neg_(1000, 5000)_seq', 'chr_20_neg_(10000, 20000)_meta', 'chr_20_neg_(10000, 20000)_seq', 'chr_20_neg_(20000, 100000)_meta', 'chr_20_neg_(20000, 100000)_seq', 'chr_20_neg_(5000, 10000)_meta', 'chr_20_neg_(5000, 10000)_seq', 'chr_20_pos_meta', 'chr_20_pos_out', 'chr_20_pos_seq', 'chr_21_neg_(1000, 5000)_meta', 'chr_21_neg_(1000, 5000)_seq', 'chr_21_neg_(10000, 20000)_meta', 'chr_21_neg_(10000, 20000)_seq', 'chr_21_neg_(20000, 100000)_meta', 'chr_21_neg_(20000, 100000)_seq', 'chr_21_neg_(5000, 10000)_meta', 'chr_21_neg_(5000, 10000)_seq', 'chr_21_pos_meta', 'chr_21_pos_out', 'chr_21_pos_seq', 'chr_22_neg_(1000, 5000)_meta', 'chr_22_neg_(1000, 5000)_seq', 'chr_22_neg_(10000, 20000)_meta', 'chr_22_neg_(10000, 20000)_seq', 'chr_22_neg_(20000, 100000)_meta', 'chr_22_neg_(20000, 100000)_seq', 'chr_22_neg_(5000, 10000)_meta', 'chr_22_neg_(5000, 10000)_seq', 'chr_22_pos_meta', 'chr_22_pos_out', 'chr_22_pos_seq', 'chr_2_neg_(1000, 5000)_meta', 'chr_2_neg_(1000, 5000)_seq', 'chr_2_neg_(10000, 20000)_meta', 'chr_2_neg_(10000, 20000)_seq', 'chr_2_neg_(20000, 100000)_meta', 'chr_2_neg_(20000, 100000)_seq', 'chr_2_neg_(5000, 10000)_meta', 'chr_2_neg_(5000, 10000)_seq', 'chr_2_pos_meta', 'chr_2_pos_out', 'chr_2_pos_seq', 'chr_3_neg_(1000, 5000)_meta', 'chr_3_neg_(1000, 5000)_seq', 'chr_3_neg_(10000, 20000)_meta', 'chr_3_neg_(10000, 20000)_seq', 'chr_3_neg_(20000, 100000)_meta', 'chr_3_neg_(20000, 100000)_seq', 'chr_3_neg_(5000, 10000)_meta', 'chr_3_neg_(5000, 10000)_seq', 'chr_3_pos_meta', 'chr_3_pos_out', 'chr_3_pos_seq', 'chr_4_neg_(1000, 5000)_meta', 'chr_4_neg_(1000, 5000)_seq', 'chr_4_neg_(10000, 20000)_meta', 'chr_4_neg_(10000, 20000)_seq', 'chr_4_neg_(20000, 100000)_meta', 'chr_4_neg_(20000, 100000)_seq', 'chr_4_neg_(5000, 10000)_meta', 'chr_4_neg_(5000, 10000)_seq', 'chr_4_pos_meta', 'chr_4_pos_out', 'chr_4_pos_seq', 'chr_5_neg_(1000, 5000)_meta', 'chr_5_neg_(1000, 5000)_seq', 'chr_5_neg_(10000, 20000)_meta', 'chr_5_neg_(10000, 20000)_seq', 'chr_5_neg_(20000, 100000)_meta', 'chr_5_neg_(20000, 100000)_seq', 'chr_5_neg_(5000, 10000)_meta', 'chr_5_neg_(5000, 10000)_seq', 'chr_5_pos_meta', 'chr_5_pos_out', 'chr_5_pos_seq', 'chr_6_neg_(1000, 5000)_meta', 'chr_6_neg_(1000, 5000)_seq', 'chr_6_neg_(10000, 20000)_meta', 'chr_6_neg_(10000, 20000)_seq', 'chr_6_neg_(20000, 100000)_meta', 'chr_6_neg_(20000, 100000)_seq', 'chr_6_neg_(5000, 10000)_meta', 'chr_6_neg_(5000, 10000)_seq', 'chr_6_pos_meta', 'chr_6_pos_out', 'chr_6_pos_seq', 'chr_7_neg_(1000, 5000)_meta', 'chr_7_neg_(1000, 5000)_seq', 'chr_7_neg_(10000, 20000)_meta', 'chr_7_neg_(10000, 20000)_seq', 'chr_7_neg_(20000, 100000)_meta', 'chr_7_neg_(20000, 100000)_seq', 'chr_7_neg_(5000, 10000)_meta', 'chr_7_neg_(5000, 10000)_seq', 'chr_7_pos_meta', 'chr_7_pos_out', 'chr_7_pos_seq', 'chr_8_neg_(1000, 5000)_meta', 'chr_8_neg_(1000, 5000)_seq', 'chr_8_neg_(10000, 20000)_meta', 'chr_8_neg_(10000, 20000)_seq', 'chr_8_neg_(20000, 100000)_meta', 'chr_8_neg_(20000, 100000)_seq', 'chr_8_neg_(5000, 10000)_meta', 'chr_8_neg_(5000, 10000)_seq', 'chr_8_pos_meta', 'chr_8_pos_out', 'chr_8_pos_seq', 'chr_9_neg_(1000, 5000)_meta', 'chr_9_neg_(1000, 5000)_seq', 'chr_9_neg_(10000, 20000)_meta', 'chr_9_neg_(10000, 20000)_seq', 'chr_9_neg_(20000, 100000)_meta', 'chr_9_neg_(20000, 100000)_seq', 'chr_9_neg_(5000, 10000)_meta', 'chr_9_neg_(5000, 10000)_seq', 'chr_9_pos_meta', 'chr_9_pos_out', 'chr_9_pos_seq', 'chr_X_neg_(1000, 5000)_meta', 'chr_X_neg_(1000, 5000)_seq', 'chr_X_neg_(10000, 20000)_meta', 'chr_X_neg_(10000, 20000)_seq', 'chr_X_neg_(20000, 100000)_meta', 'chr_X_neg_(20000, 100000)_seq', 'chr_X_neg_(5000, 10000)_meta', 'chr_X_neg_(5000, 10000)_seq', 'chr_X_pos_meta', 'chr_X_pos_out', 'chr_X_pos_seq', 'chr_Y_neg_(1000, 5000)_meta', 'chr_Y_neg_(1000, 5000)_seq', 'chr_Y_neg_(10000, 20000)_meta', 'chr_Y_neg_(10000, 20000)_seq', 'chr_Y_neg_(20000, 100000)_meta', 'chr_Y_neg_(20000, 100000)_seq', 'chr_Y_neg_(5000, 10000)_meta', 'chr_Y_neg_(5000, 10000)_seq', 'chr_Y_pos_meta', 'chr_Y_pos_out', 'chr_Y_pos_seq']
Dataset Metadata:
{'chroms': ['chr_1', 'chr_10', 'chr_11', 'chr_12', 'chr_13', 'chr_14', 'chr_15', 'chr_16', 'chr_17', 'chr_18', 'chr_19', 'chr_2', 'chr_20', 'chr_21', 'chr_22', 'chr_3', 'chr_4', 'chr_5', 'chr_6', 'chr_7', 'chr_8', 'chr_9', 'chr_X', 'chr_Y'], 'dataset_params': {'type': 'by_chrom', 'random_seed': None, 'date': '2022-10-18 17:53:34.871940'}, 'names_suffix': {'positive_dataset': '_pos_', 'negative_dataset': '_neg_', 'model_input': '_seq', 'model_output': '_out', 'chrom_extra_info': '_meta'}, 'num_2_base_dict': {'0': 'A', '1': 'C', '2': 'T', '3': 'G', '4': 'R'}, 'encoding_dict': {'A': 0, 'C': 1, 'T': 2, 'G': 3, 'N': 4, 'M': 4, 'R': 4}, 'num_reverse_compliment_dict': {'0': 2, '2': 0, '1': 3, '3': 1, '4': 4}, 'positive_metadata_cols': ['start', 'end', 'seq_midpoint', 'original_A', 'original_C', 'original_T', 'original_G', 'example_A', 'example_C', 'example_T', 'example_G', 'AA1_hotspots'], 'negative_metadata_cols': ['start', 'end', 'seq_midpoint', 'original_A', 'original_C', 'original_T', 'original_G', 'example_A', 'example_C', 'example_T', 'example_G'], 'binarize_output': True, 'negative_sampling_intervals': [[1000, 5000], [5000, 10000], [10000, 20000], [20000, 100000]], 'chroms_lens': {'chr_1': 249250621, 'chr_2': 243199373, 'chr_3': 198022430, 'chr_4': 191154276, 'chr_5': 180915260, 'chr_6': 171115067, 'chr_7': 159138663, 'chr_8': 146364022, 'chr_9': 141213431, 'chr_10': 135534747, 'chr_11': 135006516, 'chr_12': 133851895, 'chr_13': 115169878, 'chr_14': 107349540, 'chr_15': 102531392, 'chr_16': 90354753, 'chr_17': 81195210, 'chr_18': 78077248, 'chr_19': 59128983, 'chr_20': 63025520, 'chr_21': 48129895, 'chr_22': 51304566, 'chr_X': 155270560, 'chr_Y': 59373566, 'chr_MT': 16569}, 'test_set_size': 0.1, 'random_seed': 123}
Renamed Negative Examples:
{(1000, 5000): 1.0}
Expanding output out into its individual columns ['AA1_hotspots']
GETTING META chr_1_pos_meta
3692 1926.0
GETTING META chr_1_neg_(1000, 5000)_meta
3852 Training examples generated for chrom 1
	1926 positive, 1926 negative
GETTING META chr_2_pos_meta
3741 1951.0
GETTING META chr_2_neg_(1000, 5000)_meta
3902 Training examples generated for chrom 2
	1951 positive, 1951 negative
GETTING META chr_3_pos_meta
2865 1500.0
GETTING META chr_3_neg_(1000, 5000)_meta
3000 Training examples generated for chrom 3
	1500 positive, 1500 negative
GETTING META chr_4_pos_meta
3008 1577.0
GETTING META chr_4_neg_(1000, 5000)_meta
3154 Training examples generated for chrom 4
	1577 positive, 1577 negative
GETTING META chr_5_pos_meta
2702 1423.0
GETTING META chr_5_neg_(1000, 5000)_meta
2846 Training examples generated for chrom 5
	1423 positive, 1423 negative
GETTING META chr_6_pos_meta
2595 1363.0
GETTING META chr_6_neg_(1000, 5000)_meta
2726 Training examples generated for chrom 6
	1363 positive, 1363 negative
GETTING META chr_7_pos_meta
2310 1210.0
GETTING META chr_7_neg_(1000, 5000)_meta
2420 Training examples generated for chrom 7
	1210 positive, 1210 negative
GETTING META chr_8_pos_meta
2120 1120.0
GETTING META chr_8_neg_(1000, 5000)_meta
2240 Training examples generated for chrom 8
	1120 positive, 1120 negative
GETTING META chr_9_pos_meta
1818 963.0
GETTING META chr_9_neg_(1000, 5000)_meta
1926 Training examples generated for chrom 9
	963 positive, 963 negative
GETTING META chr_10_pos_meta
1865 985.0
GETTING META chr_10_neg_(1000, 5000)_meta
1970 Training examples generated for chrom 10
	985 positive, 985 negative
GETTING META chr_11_pos_meta
1704 918.0
GETTING META chr_11_neg_(1000, 5000)_meta
1836 Training examples generated for chrom 11
	918 positive, 918 negative
GETTING META chr_12_pos_meta
1829 981.0
GETTING META chr_12_neg_(1000, 5000)_meta
1962 Training examples generated for chrom 12
	981 positive, 981 negative
GETTING META chr_13_pos_meta
1747 910.0
GETTING META chr_13_neg_(1000, 5000)_meta
1820 Training examples generated for chrom 13
	910 positive, 910 negative
GETTING META chr_14_pos_meta
1733 908.0
GETTING META chr_14_neg_(1000, 5000)_meta
1816 Training examples generated for chrom 14
	908 positive, 908 negative
GETTING META chr_15_pos_meta
1436 759.0
GETTING META chr_15_neg_(1000, 5000)_meta
1518 Training examples generated for chrom 15
	759 positive, 759 negative
GETTING META chr_16_pos_meta
1215 651.0
GETTING META chr_16_neg_(1000, 5000)_meta
1302 Training examples generated for chrom 16
	651 positive, 651 negative
GETTING META chr_17_pos_meta
1076 576.0
GETTING META chr_17_neg_(1000, 5000)_meta
1152 Training examples generated for chrom 17
	576 positive, 576 negative
GETTING META chr_18_pos_meta
1236 664.0
GETTING META chr_18_neg_(1000, 5000)_meta
1328 Training examples generated for chrom 18
	664 positive, 664 negative
GETTING META chr_19_pos_meta
904 479.0
GETTING META chr_19_neg_(1000, 5000)_meta
958 Training examples generated for chrom 19
	479 positive, 479 negative
GETTING META chr_20_pos_meta
835 449.0
GETTING META chr_20_neg_(1000, 5000)_meta
898 Training examples generated for chrom 20
	449 positive, 449 negative
GETTING META chr_21_pos_meta
821 450.0
GETTING META chr_21_neg_(1000, 5000)_meta
900 Training examples generated for chrom 21
	450 positive, 450 negative
GETTING META chr_22_pos_meta
793 430.0
GETTING META chr_22_neg_(1000, 5000)_meta
860 Training examples generated for chrom 22
	430 positive, 430 negative
There are 39940 examples in the dataset
[{'input': {'seq': [], 'midpoint': []}, 'output': {'AA1_hotspots': []}, 'index': {'chrom_idx': [], 'index': [], 'ex_type': [], 'ds_index': []}}, {'input': {'seq': [], 'midpoint': []}, 'output': {'AA1_hotspots': []}, 'index': {'chrom_idx': [], 'index': [], 'ex_type': [], 'ds_index': []}}, {'input': {'seq': [], 'midpoint': []}, 'output': {'AA1_hotspots': []}, 'index': {'chrom_idx': [], 'index': [], 'ex_type': [], 'ds_index': []}}]
AA1_hotspots ['AA1_hotspots']
Epoch 1/10
209/209 [==============================] - 21s 89ms/step - loss: 0.6045 - accuracy: 0.6731 - auc: 0.7229 - precision: 0.7206 - precision_m: 0.7327 - recall: 0.5646 - recall_m: 0.5671 - f1_m: 0.6334 - val_loss: 0.5297 - val_accuracy: 0.7031 - val_auc: 0.7731 - val_precision: 0.8151 - val_precision_m: 0.8378 - val_recall: 0.5262 - val_recall_m: 0.5259 - val_f1_m: 0.6354
Epoch 2/10
209/209 [==============================] - 13s 61ms/step - loss: 0.5294 - accuracy: 0.7116 - auc: 0.7771 - precision: 0.8176 - precision_m: 0.8225 - recall: 0.5439 - recall_m: 0.5461 - f1_m: 0.6525 - val_loss: 0.5372 - val_accuracy: 0.7051 - val_auc: 0.8187 - val_precision: 0.9695 - val_precision_m: 0.9796 - val_recall: 0.4243 - val_recall_m: 0.4238 - val_f1_m: 0.5850
Epoch 3/10
209/209 [==============================] - 13s 60ms/step - loss: 0.4824 - accuracy: 0.7558 - auc: 0.8334 - precision: 0.8089 - precision_m: 0.8127 - recall: 0.6692 - recall_m: 0.6717 - f1_m: 0.7322 - val_loss: 0.8217 - val_accuracy: 0.6974 - val_auc: 0.8707 - val_precision: 0.9900 - val_precision_m: 0.9924 - val_recall: 0.3995 - val_recall_m: 0.3992 - val_f1_m: 0.5638
Epoch 4/10
209/209 [==============================] - 12s 58ms/step - loss: 0.4022 - accuracy: 0.8167 - auc: 0.8928 - precision: 0.8467 - precision_m: 0.8479 - recall: 0.7732 - recall_m: 0.7748 - f1_m: 0.8077 - val_loss: 0.7012 - val_accuracy: 0.7385 - val_auc: 0.9200 - val_precision: 0.9932 - val_precision_m: 0.9941 - val_recall: 0.4809 - val_recall_m: 0.4808 - val_f1_m: 0.6440
Epoch 5/10
209/209 [==============================] - 17s 83ms/step - loss: 0.3520 - accuracy: 0.8494 - auc: 0.9201 - precision: 0.8711 - precision_m: 0.8718 - recall: 0.8198 - recall_m: 0.8209 - f1_m: 0.8441 - val_loss: 0.4600 - val_accuracy: 0.8411 - val_auc: 0.9355 - val_precision: 0.9564 - val_precision_m: 0.9570 - val_recall: 0.7151 - val_recall_m: 0.7153 - val_f1_m: 0.8169
Epoch 6/10
209/209 [==============================] - 17s 84ms/step - loss: 0.3327 - accuracy: 0.8599 - auc: 0.9293 - precision: 0.8785 - precision_m: 0.8796 - recall: 0.8350 - recall_m: 0.8363 - f1_m: 0.8560 - val_loss: 0.3295 - val_accuracy: 0.8653 - val_auc: 0.9375 - val_precision: 0.9319 - val_precision_m: 0.9353 - val_recall: 0.7886 - val_recall_m: 0.7891 - val_f1_m: 0.8537
Epoch 7/10
209/209 [==============================] - 17s 83ms/step - loss: 0.3235 - accuracy: 0.8635 - auc: 0.9326 - precision: 0.8825 - precision_m: 0.8834 - recall: 0.8384 - recall_m: 0.8391 - f1_m: 0.8591 - val_loss: 0.3004 - val_accuracy: 0.8771 - val_auc: 0.9469 - val_precision: 0.9190 - val_precision_m: 0.9200 - val_recall: 0.8274 - val_recall_m: 0.8278 - val_f1_m: 0.8702
Epoch 8/10
209/209 [==============================] - 12s 58ms/step - loss: 0.3156 - accuracy: 0.8687 - auc: 0.9368 - precision: 0.8831 - precision_m: 0.8831 - recall: 0.8497 - recall_m: 0.8509 - f1_m: 0.8655 - val_loss: 0.3127 - val_accuracy: 0.8722 - val_auc: 0.9471 - val_precision: 0.9366 - val_precision_m: 0.9371 - val_recall: 0.7988 - val_recall_m: 0.7995 - val_f1_m: 0.8617
Epoch 9/10
 52/209 [======>.......................] - ETA: 8s - loss: 0.3159 - accuracy: 0.8721 - auc: 0.9360 - precision: 0.8879 - precision_m: 0.8882 - recall: 0.8525 - recall_m: 0.8541 - f1_m: 0.8694
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_122905-9jt0vquq/files/model-best/assets
209/209 [==============================] - 17s 82ms/step - loss: 0.3136 - accuracy: 0.8693 - auc: 0.9373 - precision: 0.8865 - precision_m: 0.8867 - recall: 0.8468 - recall_m: 0.8488 - f1_m: 0.8660 - val_loss: 0.2838 - val_accuracy: 0.8819 - val_auc: 0.9492 - val_precision: 0.8840 - val_precision_m: 0.8855 - val_recall: 0.8796 - val_recall_m: 0.8796 - val_f1_m: 0.8811
Epoch 10/10
209/209 [==============================] - 12s 58ms/step - loss: 0.3060 - accuracy: 0.8729 - auc: 0.9404 - precision: 0.8893 - precision_m: 0.8899 - recall: 0.8516 - recall_m: 0.8527 - f1_m: 0.8696 - val_loss: 0.2943 - val_accuracy: 0.8795 - val_auc: 0.9480 - val_precision: 0.9184 - val_precision_m: 0.9189 - val_recall: 0.8334 - val_recall_m: 0.8334 - val_f1_m: 0.8730
209/209 [==============================] - 17s 82ms/step - loss: 0.3136 - accuracy: 0.8693 - auc: 0.9373 - precision: 0.8865 - precision_m: 0.8867 - recall: 0.8468 - recall_m: 0.8488 - f1_m: 0.8660 - val_loss: 0.2838 - val_accuracy: 0.8819 - val_auc: 0.9492 - val_precision: 0.8840 - val_precision_m: 0.8855 - val_recall: 0.8796 - val_recall_m: 0.8796 - val_f1_m: 0.8811