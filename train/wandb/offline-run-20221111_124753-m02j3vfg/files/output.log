/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/trainer/code/dataloading/dataloading.py:218: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  data_dict['ex_type'] = np.array(example_set_index)
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best)... Done. 0.1s
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x148260c77c10>: Failed to establish a new connection: [Errno 110] Connection timed out')': /api/5288891/envelope/
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best)... Done. 0.1s
File /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/build_dataset/datasets/AA1_hotspots_seqlen=2000_multnegs.h5 was successfully opened
File opened. Found the following Folds:
['test', 'train']
Fold folder opened. Found the following datasets:
['chr_10_neg_(1000, 5000)_meta', 'chr_10_neg_(1000, 5000)_seq', 'chr_10_neg_(10000, 20000)_meta', 'chr_10_neg_(10000, 20000)_seq', 'chr_10_neg_(20000, 100000)_meta', 'chr_10_neg_(20000, 100000)_seq', 'chr_10_neg_(5000, 10000)_meta', 'chr_10_neg_(5000, 10000)_seq', 'chr_10_pos_meta', 'chr_10_pos_out', 'chr_10_pos_seq', 'chr_11_neg_(1000, 5000)_meta', 'chr_11_neg_(1000, 5000)_seq', 'chr_11_neg_(10000, 20000)_meta', 'chr_11_neg_(10000, 20000)_seq', 'chr_11_neg_(20000, 100000)_meta', 'chr_11_neg_(20000, 100000)_seq', 'chr_11_neg_(5000, 10000)_meta', 'chr_11_neg_(5000, 10000)_seq', 'chr_11_pos_meta', 'chr_11_pos_out', 'chr_11_pos_seq', 'chr_12_neg_(1000, 5000)_meta', 'chr_12_neg_(1000, 5000)_seq', 'chr_12_neg_(10000, 20000)_meta', 'chr_12_neg_(10000, 20000)_seq', 'chr_12_neg_(20000, 100000)_meta', 'chr_12_neg_(20000, 100000)_seq', 'chr_12_neg_(5000, 10000)_meta', 'chr_12_neg_(5000, 10000)_seq', 'chr_12_pos_meta', 'chr_12_pos_out', 'chr_12_pos_seq', 'chr_13_neg_(1000, 5000)_meta', 'chr_13_neg_(1000, 5000)_seq', 'chr_13_neg_(10000, 20000)_meta', 'chr_13_neg_(10000, 20000)_seq', 'chr_13_neg_(20000, 100000)_meta', 'chr_13_neg_(20000, 100000)_seq', 'chr_13_neg_(5000, 10000)_meta', 'chr_13_neg_(5000, 10000)_seq', 'chr_13_pos_meta', 'chr_13_pos_out', 'chr_13_pos_seq', 'chr_14_neg_(1000, 5000)_meta', 'chr_14_neg_(1000, 5000)_seq', 'chr_14_neg_(10000, 20000)_meta', 'chr_14_neg_(10000, 20000)_seq', 'chr_14_neg_(20000, 100000)_meta', 'chr_14_neg_(20000, 100000)_seq', 'chr_14_neg_(5000, 10000)_meta', 'chr_14_neg_(5000, 10000)_seq', 'chr_14_pos_meta', 'chr_14_pos_out', 'chr_14_pos_seq', 'chr_15_neg_(1000, 5000)_meta', 'chr_15_neg_(1000, 5000)_seq', 'chr_15_neg_(10000, 20000)_meta', 'chr_15_neg_(10000, 20000)_seq', 'chr_15_neg_(20000, 100000)_meta', 'chr_15_neg_(20000, 100000)_seq', 'chr_15_neg_(5000, 10000)_meta', 'chr_15_neg_(5000, 10000)_seq', 'chr_15_pos_meta', 'chr_15_pos_out', 'chr_15_pos_seq', 'chr_16_neg_(1000, 5000)_meta', 'chr_16_neg_(1000, 5000)_seq', 'chr_16_neg_(10000, 20000)_meta', 'chr_16_neg_(10000, 20000)_seq', 'chr_16_neg_(20000, 100000)_meta', 'chr_16_neg_(20000, 100000)_seq', 'chr_16_neg_(5000, 10000)_meta', 'chr_16_neg_(5000, 10000)_seq', 'chr_16_pos_meta', 'chr_16_pos_out', 'chr_16_pos_seq', 'chr_17_neg_(1000, 5000)_meta', 'chr_17_neg_(1000, 5000)_seq', 'chr_17_neg_(10000, 20000)_meta', 'chr_17_neg_(10000, 20000)_seq', 'chr_17_neg_(20000, 100000)_meta', 'chr_17_neg_(20000, 100000)_seq', 'chr_17_neg_(5000, 10000)_meta', 'chr_17_neg_(5000, 10000)_seq', 'chr_17_pos_meta', 'chr_17_pos_out', 'chr_17_pos_seq', 'chr_18_neg_(1000, 5000)_meta', 'chr_18_neg_(1000, 5000)_seq', 'chr_18_neg_(10000, 20000)_meta', 'chr_18_neg_(10000, 20000)_seq', 'chr_18_neg_(20000, 100000)_meta', 'chr_18_neg_(20000, 100000)_seq', 'chr_18_neg_(5000, 10000)_meta', 'chr_18_neg_(5000, 10000)_seq', 'chr_18_pos_meta', 'chr_18_pos_out', 'chr_18_pos_seq', 'chr_19_neg_(1000, 5000)_meta', 'chr_19_neg_(1000, 5000)_seq', 'chr_19_neg_(10000, 20000)_meta', 'chr_19_neg_(10000, 20000)_seq', 'chr_19_neg_(20000, 100000)_meta', 'chr_19_neg_(20000, 100000)_seq', 'chr_19_neg_(5000, 10000)_meta', 'chr_19_neg_(5000, 10000)_seq', 'chr_19_pos_meta', 'chr_19_pos_out', 'chr_19_pos_seq', 'chr_1_neg_(1000, 5000)_meta', 'chr_1_neg_(1000, 5000)_seq', 'chr_1_neg_(10000, 20000)_meta', 'chr_1_neg_(10000, 20000)_seq', 'chr_1_neg_(20000, 100000)_meta', 'chr_1_neg_(20000, 100000)_seq', 'chr_1_neg_(5000, 10000)_meta', 'chr_1_neg_(5000, 10000)_seq', 'chr_1_pos_meta', 'chr_1_pos_out', 'chr_1_pos_seq', 'chr_20_neg_(1000, 5000)_meta', 'chr_20_neg_(1000, 5000)_seq', 'chr_20_neg_(10000, 20000)_meta', 'chr_20_neg_(10000, 20000)_seq', 'chr_20_neg_(20000, 100000)_meta', 'chr_20_neg_(20000, 100000)_seq', 'chr_20_neg_(5000, 10000)_meta', 'chr_20_neg_(5000, 10000)_seq', 'chr_20_pos_meta', 'chr_20_pos_out', 'chr_20_pos_seq', 'chr_21_neg_(1000, 5000)_meta', 'chr_21_neg_(1000, 5000)_seq', 'chr_21_neg_(10000, 20000)_meta', 'chr_21_neg_(10000, 20000)_seq', 'chr_21_neg_(20000, 100000)_meta', 'chr_21_neg_(20000, 100000)_seq', 'chr_21_neg_(5000, 10000)_meta', 'chr_21_neg_(5000, 10000)_seq', 'chr_21_pos_meta', 'chr_21_pos_out', 'chr_21_pos_seq', 'chr_22_neg_(1000, 5000)_meta', 'chr_22_neg_(1000, 5000)_seq', 'chr_22_neg_(10000, 20000)_meta', 'chr_22_neg_(10000, 20000)_seq', 'chr_22_neg_(20000, 100000)_meta', 'chr_22_neg_(20000, 100000)_seq', 'chr_22_neg_(5000, 10000)_meta', 'chr_22_neg_(5000, 10000)_seq', 'chr_22_pos_meta', 'chr_22_pos_out', 'chr_22_pos_seq', 'chr_2_neg_(1000, 5000)_meta', 'chr_2_neg_(1000, 5000)_seq', 'chr_2_neg_(10000, 20000)_meta', 'chr_2_neg_(10000, 20000)_seq', 'chr_2_neg_(20000, 100000)_meta', 'chr_2_neg_(20000, 100000)_seq', 'chr_2_neg_(5000, 10000)_meta', 'chr_2_neg_(5000, 10000)_seq', 'chr_2_pos_meta', 'chr_2_pos_out', 'chr_2_pos_seq', 'chr_3_neg_(1000, 5000)_meta', 'chr_3_neg_(1000, 5000)_seq', 'chr_3_neg_(10000, 20000)_meta', 'chr_3_neg_(10000, 20000)_seq', 'chr_3_neg_(20000, 100000)_meta', 'chr_3_neg_(20000, 100000)_seq', 'chr_3_neg_(5000, 10000)_meta', 'chr_3_neg_(5000, 10000)_seq', 'chr_3_pos_meta', 'chr_3_pos_out', 'chr_3_pos_seq', 'chr_4_neg_(1000, 5000)_meta', 'chr_4_neg_(1000, 5000)_seq', 'chr_4_neg_(10000, 20000)_meta', 'chr_4_neg_(10000, 20000)_seq', 'chr_4_neg_(20000, 100000)_meta', 'chr_4_neg_(20000, 100000)_seq', 'chr_4_neg_(5000, 10000)_meta', 'chr_4_neg_(5000, 10000)_seq', 'chr_4_pos_meta', 'chr_4_pos_out', 'chr_4_pos_seq', 'chr_5_neg_(1000, 5000)_meta', 'chr_5_neg_(1000, 5000)_seq', 'chr_5_neg_(10000, 20000)_meta', 'chr_5_neg_(10000, 20000)_seq', 'chr_5_neg_(20000, 100000)_meta', 'chr_5_neg_(20000, 100000)_seq', 'chr_5_neg_(5000, 10000)_meta', 'chr_5_neg_(5000, 10000)_seq', 'chr_5_pos_meta', 'chr_5_pos_out', 'chr_5_pos_seq', 'chr_6_neg_(1000, 5000)_meta', 'chr_6_neg_(1000, 5000)_seq', 'chr_6_neg_(10000, 20000)_meta', 'chr_6_neg_(10000, 20000)_seq', 'chr_6_neg_(20000, 100000)_meta', 'chr_6_neg_(20000, 100000)_seq', 'chr_6_neg_(5000, 10000)_meta', 'chr_6_neg_(5000, 10000)_seq', 'chr_6_pos_meta', 'chr_6_pos_out', 'chr_6_pos_seq', 'chr_7_neg_(1000, 5000)_meta', 'chr_7_neg_(1000, 5000)_seq', 'chr_7_neg_(10000, 20000)_meta', 'chr_7_neg_(10000, 20000)_seq', 'chr_7_neg_(20000, 100000)_meta', 'chr_7_neg_(20000, 100000)_seq', 'chr_7_neg_(5000, 10000)_meta', 'chr_7_neg_(5000, 10000)_seq', 'chr_7_pos_meta', 'chr_7_pos_out', 'chr_7_pos_seq', 'chr_8_neg_(1000, 5000)_meta', 'chr_8_neg_(1000, 5000)_seq', 'chr_8_neg_(10000, 20000)_meta', 'chr_8_neg_(10000, 20000)_seq', 'chr_8_neg_(20000, 100000)_meta', 'chr_8_neg_(20000, 100000)_seq', 'chr_8_neg_(5000, 10000)_meta', 'chr_8_neg_(5000, 10000)_seq', 'chr_8_pos_meta', 'chr_8_pos_out', 'chr_8_pos_seq', 'chr_9_neg_(1000, 5000)_meta', 'chr_9_neg_(1000, 5000)_seq', 'chr_9_neg_(10000, 20000)_meta', 'chr_9_neg_(10000, 20000)_seq', 'chr_9_neg_(20000, 100000)_meta', 'chr_9_neg_(20000, 100000)_seq', 'chr_9_neg_(5000, 10000)_meta', 'chr_9_neg_(5000, 10000)_seq', 'chr_9_pos_meta', 'chr_9_pos_out', 'chr_9_pos_seq', 'chr_X_neg_(1000, 5000)_meta', 'chr_X_neg_(1000, 5000)_seq', 'chr_X_neg_(10000, 20000)_meta', 'chr_X_neg_(10000, 20000)_seq', 'chr_X_neg_(20000, 100000)_meta', 'chr_X_neg_(20000, 100000)_seq', 'chr_X_neg_(5000, 10000)_meta', 'chr_X_neg_(5000, 10000)_seq', 'chr_X_pos_meta', 'chr_X_pos_out', 'chr_X_pos_seq', 'chr_Y_neg_(1000, 5000)_meta', 'chr_Y_neg_(1000, 5000)_seq', 'chr_Y_neg_(10000, 20000)_meta', 'chr_Y_neg_(10000, 20000)_seq', 'chr_Y_neg_(20000, 100000)_meta', 'chr_Y_neg_(20000, 100000)_seq', 'chr_Y_neg_(5000, 10000)_meta', 'chr_Y_neg_(5000, 10000)_seq', 'chr_Y_pos_meta', 'chr_Y_pos_out', 'chr_Y_pos_seq']
Dataset Metadata:
{'chroms': ['chr_1', 'chr_10', 'chr_11', 'chr_12', 'chr_13', 'chr_14', 'chr_15', 'chr_16', 'chr_17', 'chr_18', 'chr_19', 'chr_2', 'chr_20', 'chr_21', 'chr_22', 'chr_3', 'chr_4', 'chr_5', 'chr_6', 'chr_7', 'chr_8', 'chr_9', 'chr_X', 'chr_Y'], 'dataset_params': {'type': 'by_chrom', 'random_seed': None, 'date': '2022-10-18 17:57:22.559326'}, 'names_suffix': {'positive_dataset': '_pos_', 'negative_dataset': '_neg_', 'model_input': '_seq', 'model_output': '_out', 'chrom_extra_info': '_meta'}, 'num_2_base_dict': {'0': 'A', '1': 'C', '2': 'T', '3': 'G', '4': 'R'}, 'encoding_dict': {'A': 0, 'C': 1, 'T': 2, 'G': 3, 'N': 4, 'M': 4, 'R': 4}, 'num_reverse_compliment_dict': {'0': 2, '2': 0, '1': 3, '3': 1, '4': 4}, 'positive_metadata_cols': ['start', 'end', 'seq_midpoint', 'original_A', 'original_C', 'original_T', 'original_G', 'example_A', 'example_C', 'example_T', 'example_G', 'AA1_hotspots'], 'negative_metadata_cols': ['start', 'end', 'seq_midpoint', 'original_A', 'original_C', 'original_T', 'original_G', 'example_A', 'example_C', 'example_T', 'example_G'], 'binarize_output': True, 'negative_sampling_intervals': [[1000, 5000], [5000, 10000], [10000, 20000], [20000, 100000]], 'chroms_lens': {'chr_1': 249250621, 'chr_2': 243199373, 'chr_3': 198022430, 'chr_4': 191154276, 'chr_5': 180915260, 'chr_6': 171115067, 'chr_7': 159138663, 'chr_8': 146364022, 'chr_9': 141213431, 'chr_10': 135534747, 'chr_11': 135006516, 'chr_12': 133851895, 'chr_13': 115169878, 'chr_14': 107349540, 'chr_15': 102531392, 'chr_16': 90354753, 'chr_17': 81195210, 'chr_18': 78077248, 'chr_19': 59128983, 'chr_20': 63025520, 'chr_21': 48129895, 'chr_22': 51304566, 'chr_X': 155270560, 'chr_Y': 59373566, 'chr_MT': 16569}, 'test_set_size': 0.1, 'random_seed': 123}
Renamed Negative Examples:
{(1000, 5000): 1.0}
Expanding output out into its individual columns ['AA1_hotspots']
GETTING META chr_1_pos_meta
3690 1926.0
GETTING META chr_1_neg_(1000, 5000)_meta
3852 Training examples generated for chrom 1
	1926 positive, 1926 negative
GETTING META chr_2_pos_meta
3741 1950.0
GETTING META chr_2_neg_(1000, 5000)_meta
3900 Training examples generated for chrom 2
	1950 positive, 1950 negative
GETTING META chr_3_pos_meta
2865 1500.0
GETTING META chr_3_neg_(1000, 5000)_meta
3000 Training examples generated for chrom 3
	1500 positive, 1500 negative
GETTING META chr_4_pos_meta
3008 1577.0
GETTING META chr_4_neg_(1000, 5000)_meta
3154 Training examples generated for chrom 4
	1577 positive, 1577 negative
GETTING META chr_5_pos_meta
2703 1423.0
GETTING META chr_5_neg_(1000, 5000)_meta
2846 Training examples generated for chrom 5
	1423 positive, 1423 negative
GETTING META chr_6_pos_meta
2595 1362.0
GETTING META chr_6_neg_(1000, 5000)_meta
2724 Training examples generated for chrom 6
	1362 positive, 1362 negative
GETTING META chr_7_pos_meta
2310 1209.0
GETTING META chr_7_neg_(1000, 5000)_meta
2418 Training examples generated for chrom 7
	1209 positive, 1209 negative
GETTING META chr_8_pos_meta
2120 1120.0
GETTING META chr_8_neg_(1000, 5000)_meta
2240 Training examples generated for chrom 8
	1120 positive, 1120 negative
GETTING META chr_9_pos_meta
1818 963.0
GETTING META chr_9_neg_(1000, 5000)_meta
1926 Training examples generated for chrom 9
	963 positive, 963 negative
GETTING META chr_10_pos_meta
1865 984.0
GETTING META chr_10_neg_(1000, 5000)_meta
1968 Training examples generated for chrom 10
	984 positive, 984 negative
GETTING META chr_11_pos_meta
1704 918.0
GETTING META chr_11_neg_(1000, 5000)_meta
1836 Training examples generated for chrom 11
	918 positive, 918 negative
GETTING META chr_12_pos_meta
1829 981.0
GETTING META chr_12_neg_(1000, 5000)_meta
1962 Training examples generated for chrom 12
	981 positive, 981 negative
GETTING META chr_13_pos_meta
1747 910.0
GETTING META chr_13_neg_(1000, 5000)_meta
1820 Training examples generated for chrom 13
	910 positive, 910 negative
GETTING META chr_14_pos_meta
1733 908.0
GETTING META chr_14_neg_(1000, 5000)_meta
1816 Training examples generated for chrom 14
	908 positive, 908 negative
GETTING META chr_15_pos_meta
1435 759.0
GETTING META chr_15_neg_(1000, 5000)_meta
1518 Training examples generated for chrom 15
	759 positive, 759 negative
GETTING META chr_16_pos_meta
1215 650.0
GETTING META chr_16_neg_(1000, 5000)_meta
1300 Training examples generated for chrom 16
	650 positive, 650 negative
GETTING META chr_17_pos_meta
1076 576.0
GETTING META chr_17_neg_(1000, 5000)_meta
1152 Training examples generated for chrom 17
	576 positive, 576 negative
GETTING META chr_18_pos_meta
1236 664.0
GETTING META chr_18_neg_(1000, 5000)_meta
1328 Training examples generated for chrom 18
	664 positive, 664 negative
GETTING META chr_19_pos_meta
904 479.0
GETTING META chr_19_neg_(1000, 5000)_meta
958 Training examples generated for chrom 19
	479 positive, 479 negative
GETTING META chr_20_pos_meta
835 449.0
GETTING META chr_20_neg_(1000, 5000)_meta
898 Training examples generated for chrom 20
	449 positive, 449 negative
GETTING META chr_21_pos_meta
821 449.0
GETTING META chr_21_neg_(1000, 5000)_meta
898 Training examples generated for chrom 21
	449 positive, 449 negative
GETTING META chr_22_pos_meta
793 430.0
GETTING META chr_22_neg_(1000, 5000)_meta
860 Training examples generated for chrom 22
	430 positive, 430 negative
There are 39930 examples in the dataset
dict_keys(['chrom_idx', 'index', 'ex_type', 'ds_index'])
AA1_hotspots ['AA1_hotspots']
Epoch 1/10
208/208 [==============================] - 38s 169ms/step - loss: 0.6070 - accuracy: 0.6713 - auc: 0.7269 - precision: 0.7073 - precision_m: 0.7198 - recall: 0.5876 - recall_m: 0.5887 - f1_m: 0.6414 - val_loss: 0.5516 - val_accuracy: 0.7092 - val_auc: 0.7991 - val_precision: 0.7126 - val_precision_m: 0.7120 - val_recall: 0.6958 - val_recall_m: 0.6944 - val_f1_m: 0.7016
Epoch 2/10
208/208 [==============================] - 34s 165ms/step - loss: 0.4947 - accuracy: 0.7345 - auc: 0.8089 - precision: 0.8150 - precision_m: 0.8186 - recall: 0.6085 - recall_m: 0.6102 - f1_m: 0.6953 - val_loss: 0.4703 - val_accuracy: 0.7416 - val_auc: 0.8393 - val_precision: 0.9009 - val_precision_m: 0.8999 - val_recall: 0.5397 - val_recall_m: 0.5391 - val_f1_m: 0.6724
Epoch 3/10
208/208 [==============================] - 35s 166ms/step - loss: 0.4660 - accuracy: 0.7613 - auc: 0.8390 - precision: 0.8229 - precision_m: 0.8254 - recall: 0.6676 - recall_m: 0.6692 - f1_m: 0.7364 - val_loss: 0.4296 - val_accuracy: 0.7851 - val_auc: 0.8714 - val_precision: 0.8989 - val_precision_m: 0.8983 - val_recall: 0.6397 - val_recall_m: 0.6394 - val_f1_m: 0.7455
Epoch 4/10
208/208 [==============================] - 34s 163ms/step - loss: 0.4109 - accuracy: 0.8064 - auc: 0.8821 - precision: 0.8569 - precision_m: 0.8575 - recall: 0.7368 - recall_m: 0.7384 - f1_m: 0.7913 - val_loss: 0.4103 - val_accuracy: 0.8092 - val_auc: 0.9172 - val_precision: 0.9559 - val_precision_m: 0.9555 - val_recall: 0.6459 - val_recall_m: 0.6462 - val_f1_m: 0.7695
Epoch 5/10
208/208 [==============================] - ETA: 0s - loss: 0.3512 - accuracy: 0.8443 - auc: 0.9178 - precision: 0.8753 - precision_m: 0.8757 - recall: 0.8040 - recall_m: 0.8059 - f1_m: 0.8376
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best)... Done. 0.1s
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x148240df7f10>: Failed to establish a new connection: [Errno 110] Connection timed out')': /api/5288891/envelope/
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_124753-m02j3vfg/files/model-best/assets
208/208 [==============================] - 34s 163ms/step - loss: 0.3512 - accuracy: 0.8443 - auc: 0.9178 - precision: 0.8753 - precision_m: 0.8757 - recall: 0.8040 - recall_m: 0.8059 - f1_m: 0.8376 - val_loss: 0.3854 - val_accuracy: 0.8403 - val_auc: 0.9408 - val_precision: 0.9654 - val_precision_m: 0.9650 - val_recall: 0.7039 - val_recall_m: 0.7043 - val_f1_m: 0.8131
Epoch 6/10
208/208 [==============================] - 34s 162ms/step - loss: 0.3314 - accuracy: 0.8558 - auc: 0.9283 - precision: 0.8806 - precision_m: 0.8808 - recall: 0.8242 - recall_m: 0.8262 - f1_m: 0.8509 - val_loss: 0.3485 - val_accuracy: 0.8591 - val_auc: 0.9458 - val_precision: 0.9546 - val_precision_m: 0.9543 - val_recall: 0.7525 - val_recall_m: 0.7523 - val_f1_m: 0.8402
Epoch 7/10
208/208 [==============================] - 34s 162ms/step - loss: 0.3143 - accuracy: 0.8667 - auc: 0.9357 - precision: 0.8882 - precision_m: 0.8885 - recall: 0.8397 - recall_m: 0.8413 - f1_m: 0.8626 - val_loss: 0.2971 - val_accuracy: 0.8733 - val_auc: 0.9506 - val_precision: 0.8440 - val_precision_m: 0.8440 - val_recall: 0.9140 - val_recall_m: 0.9141 - val_f1_m: 0.8766
Epoch 8/10
208/208 [==============================] - 29s 138ms/step - loss: 0.3037 - accuracy: 0.8735 - auc: 0.9407 - precision: 0.8952 - precision_m: 0.8952 - recall: 0.8468 - recall_m: 0.8486 - f1_m: 0.8698 - val_loss: 0.2974 - val_accuracy: 0.8774 - val_auc: 0.9499 - val_precision: 0.9230 - val_precision_m: 0.9229 - val_recall: 0.8220 - val_recall_m: 0.8225 - val_f1_m: 0.8687
Epoch 9/10
208/208 [==============================] - 28s 136ms/step - loss: 0.2939 - accuracy: 0.8771 - auc: 0.9448 - precision: 0.8977 - precision_m: 0.8977 - recall: 0.8519 - recall_m: 0.8536 - f1_m: 0.8738 - val_loss: 0.3367 - val_accuracy: 0.8542 - val_auc: 0.9499 - val_precision: 0.9729 - val_precision_m: 0.9728 - val_recall: 0.7271 - val_recall_m: 0.7276 - val_f1_m: 0.8314
Epoch 10/10
208/208 [==============================] - 34s 162ms/step - loss: 0.2870 - accuracy: 0.8825 - auc: 0.9468 - precision: 0.9033 - precision_m: 0.9032 - recall: 0.8575 - recall_m: 0.8593 - f1_m: 0.8794 - val_loss: 0.2923 - val_accuracy: 0.8796 - val_auc: 0.9520 - val_precision: 0.9532 - val_precision_m: 0.9531 - val_recall: 0.7969 - val_recall_m: 0.7974 - val_f1_m: 0.8673
208/208 [==============================] - 34s 163ms/step - loss: 0.3512 - accuracy: 0.8443 - auc: 0.9178 - precision: 0.8753 - precision_m: 0.8757 - recall: 0.8040 - recall_m: 0.8059 - f1_m: 0.8376 - val_loss: 0.3854 - val_accuracy: 0.8403 - val_auc: 0.9408 - val_precision: 0.9654 - val_precision_m: 0.9650 - val_recall: 0.7039 - val_recall_m: 0.7043 - val_f1_m: 0.8131