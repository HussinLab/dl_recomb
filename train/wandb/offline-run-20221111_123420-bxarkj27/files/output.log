/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/trainer/code/dataloading/dataloading.py:218: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  data_dict['ex_type'] = np.array(example_set_index)
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1482617ae610>: Failed to establish a new connection: [Errno 110] Connection timed out')': /api/5288891/envelope/
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best)... Done. 0.1s
File /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/build_dataset/datasets/AA1_hotspots_seqlen=800_multnegs.h5 was successfully opened
File opened. Found the following Folds:
['test', 'train']
Fold folder opened. Found the following datasets:
['chr_10_neg_(1000, 5000)_meta', 'chr_10_neg_(1000, 5000)_seq', 'chr_10_neg_(10000, 20000)_meta', 'chr_10_neg_(10000, 20000)_seq', 'chr_10_neg_(20000, 100000)_meta', 'chr_10_neg_(20000, 100000)_seq', 'chr_10_neg_(5000, 10000)_meta', 'chr_10_neg_(5000, 10000)_seq', 'chr_10_pos_meta', 'chr_10_pos_out', 'chr_10_pos_seq', 'chr_11_neg_(1000, 5000)_meta', 'chr_11_neg_(1000, 5000)_seq', 'chr_11_neg_(10000, 20000)_meta', 'chr_11_neg_(10000, 20000)_seq', 'chr_11_neg_(20000, 100000)_meta', 'chr_11_neg_(20000, 100000)_seq', 'chr_11_neg_(5000, 10000)_meta', 'chr_11_neg_(5000, 10000)_seq', 'chr_11_pos_meta', 'chr_11_pos_out', 'chr_11_pos_seq', 'chr_12_neg_(1000, 5000)_meta', 'chr_12_neg_(1000, 5000)_seq', 'chr_12_neg_(10000, 20000)_meta', 'chr_12_neg_(10000, 20000)_seq', 'chr_12_neg_(20000, 100000)_meta', 'chr_12_neg_(20000, 100000)_seq', 'chr_12_neg_(5000, 10000)_meta', 'chr_12_neg_(5000, 10000)_seq', 'chr_12_pos_meta', 'chr_12_pos_out', 'chr_12_pos_seq', 'chr_13_neg_(1000, 5000)_meta', 'chr_13_neg_(1000, 5000)_seq', 'chr_13_neg_(10000, 20000)_meta', 'chr_13_neg_(10000, 20000)_seq', 'chr_13_neg_(20000, 100000)_meta', 'chr_13_neg_(20000, 100000)_seq', 'chr_13_neg_(5000, 10000)_meta', 'chr_13_neg_(5000, 10000)_seq', 'chr_13_pos_meta', 'chr_13_pos_out', 'chr_13_pos_seq', 'chr_14_neg_(1000, 5000)_meta', 'chr_14_neg_(1000, 5000)_seq', 'chr_14_neg_(10000, 20000)_meta', 'chr_14_neg_(10000, 20000)_seq', 'chr_14_neg_(20000, 100000)_meta', 'chr_14_neg_(20000, 100000)_seq', 'chr_14_neg_(5000, 10000)_meta', 'chr_14_neg_(5000, 10000)_seq', 'chr_14_pos_meta', 'chr_14_pos_out', 'chr_14_pos_seq', 'chr_15_neg_(1000, 5000)_meta', 'chr_15_neg_(1000, 5000)_seq', 'chr_15_neg_(10000, 20000)_meta', 'chr_15_neg_(10000, 20000)_seq', 'chr_15_neg_(20000, 100000)_meta', 'chr_15_neg_(20000, 100000)_seq', 'chr_15_neg_(5000, 10000)_meta', 'chr_15_neg_(5000, 10000)_seq', 'chr_15_pos_meta', 'chr_15_pos_out', 'chr_15_pos_seq', 'chr_16_neg_(1000, 5000)_meta', 'chr_16_neg_(1000, 5000)_seq', 'chr_16_neg_(10000, 20000)_meta', 'chr_16_neg_(10000, 20000)_seq', 'chr_16_neg_(20000, 100000)_meta', 'chr_16_neg_(20000, 100000)_seq', 'chr_16_neg_(5000, 10000)_meta', 'chr_16_neg_(5000, 10000)_seq', 'chr_16_pos_meta', 'chr_16_pos_out', 'chr_16_pos_seq', 'chr_17_neg_(1000, 5000)_meta', 'chr_17_neg_(1000, 5000)_seq', 'chr_17_neg_(10000, 20000)_meta', 'chr_17_neg_(10000, 20000)_seq', 'chr_17_neg_(20000, 100000)_meta', 'chr_17_neg_(20000, 100000)_seq', 'chr_17_neg_(5000, 10000)_meta', 'chr_17_neg_(5000, 10000)_seq', 'chr_17_pos_meta', 'chr_17_pos_out', 'chr_17_pos_seq', 'chr_18_neg_(1000, 5000)_meta', 'chr_18_neg_(1000, 5000)_seq', 'chr_18_neg_(10000, 20000)_meta', 'chr_18_neg_(10000, 20000)_seq', 'chr_18_neg_(20000, 100000)_meta', 'chr_18_neg_(20000, 100000)_seq', 'chr_18_neg_(5000, 10000)_meta', 'chr_18_neg_(5000, 10000)_seq', 'chr_18_pos_meta', 'chr_18_pos_out', 'chr_18_pos_seq', 'chr_19_neg_(1000, 5000)_meta', 'chr_19_neg_(1000, 5000)_seq', 'chr_19_neg_(10000, 20000)_meta', 'chr_19_neg_(10000, 20000)_seq', 'chr_19_neg_(20000, 100000)_meta', 'chr_19_neg_(20000, 100000)_seq', 'chr_19_neg_(5000, 10000)_meta', 'chr_19_neg_(5000, 10000)_seq', 'chr_19_pos_meta', 'chr_19_pos_out', 'chr_19_pos_seq', 'chr_1_neg_(1000, 5000)_meta', 'chr_1_neg_(1000, 5000)_seq', 'chr_1_neg_(10000, 20000)_meta', 'chr_1_neg_(10000, 20000)_seq', 'chr_1_neg_(20000, 100000)_meta', 'chr_1_neg_(20000, 100000)_seq', 'chr_1_neg_(5000, 10000)_meta', 'chr_1_neg_(5000, 10000)_seq', 'chr_1_pos_meta', 'chr_1_pos_out', 'chr_1_pos_seq', 'chr_20_neg_(1000, 5000)_meta', 'chr_20_neg_(1000, 5000)_seq', 'chr_20_neg_(10000, 20000)_meta', 'chr_20_neg_(10000, 20000)_seq', 'chr_20_neg_(20000, 100000)_meta', 'chr_20_neg_(20000, 100000)_seq', 'chr_20_neg_(5000, 10000)_meta', 'chr_20_neg_(5000, 10000)_seq', 'chr_20_pos_meta', 'chr_20_pos_out', 'chr_20_pos_seq', 'chr_21_neg_(1000, 5000)_meta', 'chr_21_neg_(1000, 5000)_seq', 'chr_21_neg_(10000, 20000)_meta', 'chr_21_neg_(10000, 20000)_seq', 'chr_21_neg_(20000, 100000)_meta', 'chr_21_neg_(20000, 100000)_seq', 'chr_21_neg_(5000, 10000)_meta', 'chr_21_neg_(5000, 10000)_seq', 'chr_21_pos_meta', 'chr_21_pos_out', 'chr_21_pos_seq', 'chr_22_neg_(1000, 5000)_meta', 'chr_22_neg_(1000, 5000)_seq', 'chr_22_neg_(10000, 20000)_meta', 'chr_22_neg_(10000, 20000)_seq', 'chr_22_neg_(20000, 100000)_meta', 'chr_22_neg_(20000, 100000)_seq', 'chr_22_neg_(5000, 10000)_meta', 'chr_22_neg_(5000, 10000)_seq', 'chr_22_pos_meta', 'chr_22_pos_out', 'chr_22_pos_seq', 'chr_2_neg_(1000, 5000)_meta', 'chr_2_neg_(1000, 5000)_seq', 'chr_2_neg_(10000, 20000)_meta', 'chr_2_neg_(10000, 20000)_seq', 'chr_2_neg_(20000, 100000)_meta', 'chr_2_neg_(20000, 100000)_seq', 'chr_2_neg_(5000, 10000)_meta', 'chr_2_neg_(5000, 10000)_seq', 'chr_2_pos_meta', 'chr_2_pos_out', 'chr_2_pos_seq', 'chr_3_neg_(1000, 5000)_meta', 'chr_3_neg_(1000, 5000)_seq', 'chr_3_neg_(10000, 20000)_meta', 'chr_3_neg_(10000, 20000)_seq', 'chr_3_neg_(20000, 100000)_meta', 'chr_3_neg_(20000, 100000)_seq', 'chr_3_neg_(5000, 10000)_meta', 'chr_3_neg_(5000, 10000)_seq', 'chr_3_pos_meta', 'chr_3_pos_out', 'chr_3_pos_seq', 'chr_4_neg_(1000, 5000)_meta', 'chr_4_neg_(1000, 5000)_seq', 'chr_4_neg_(10000, 20000)_meta', 'chr_4_neg_(10000, 20000)_seq', 'chr_4_neg_(20000, 100000)_meta', 'chr_4_neg_(20000, 100000)_seq', 'chr_4_neg_(5000, 10000)_meta', 'chr_4_neg_(5000, 10000)_seq', 'chr_4_pos_meta', 'chr_4_pos_out', 'chr_4_pos_seq', 'chr_5_neg_(1000, 5000)_meta', 'chr_5_neg_(1000, 5000)_seq', 'chr_5_neg_(10000, 20000)_meta', 'chr_5_neg_(10000, 20000)_seq', 'chr_5_neg_(20000, 100000)_meta', 'chr_5_neg_(20000, 100000)_seq', 'chr_5_neg_(5000, 10000)_meta', 'chr_5_neg_(5000, 10000)_seq', 'chr_5_pos_meta', 'chr_5_pos_out', 'chr_5_pos_seq', 'chr_6_neg_(1000, 5000)_meta', 'chr_6_neg_(1000, 5000)_seq', 'chr_6_neg_(10000, 20000)_meta', 'chr_6_neg_(10000, 20000)_seq', 'chr_6_neg_(20000, 100000)_meta', 'chr_6_neg_(20000, 100000)_seq', 'chr_6_neg_(5000, 10000)_meta', 'chr_6_neg_(5000, 10000)_seq', 'chr_6_pos_meta', 'chr_6_pos_out', 'chr_6_pos_seq', 'chr_7_neg_(1000, 5000)_meta', 'chr_7_neg_(1000, 5000)_seq', 'chr_7_neg_(10000, 20000)_meta', 'chr_7_neg_(10000, 20000)_seq', 'chr_7_neg_(20000, 100000)_meta', 'chr_7_neg_(20000, 100000)_seq', 'chr_7_neg_(5000, 10000)_meta', 'chr_7_neg_(5000, 10000)_seq', 'chr_7_pos_meta', 'chr_7_pos_out', 'chr_7_pos_seq', 'chr_8_neg_(1000, 5000)_meta', 'chr_8_neg_(1000, 5000)_seq', 'chr_8_neg_(10000, 20000)_meta', 'chr_8_neg_(10000, 20000)_seq', 'chr_8_neg_(20000, 100000)_meta', 'chr_8_neg_(20000, 100000)_seq', 'chr_8_neg_(5000, 10000)_meta', 'chr_8_neg_(5000, 10000)_seq', 'chr_8_pos_meta', 'chr_8_pos_out', 'chr_8_pos_seq', 'chr_9_neg_(1000, 5000)_meta', 'chr_9_neg_(1000, 5000)_seq', 'chr_9_neg_(10000, 20000)_meta', 'chr_9_neg_(10000, 20000)_seq', 'chr_9_neg_(20000, 100000)_meta', 'chr_9_neg_(20000, 100000)_seq', 'chr_9_neg_(5000, 10000)_meta', 'chr_9_neg_(5000, 10000)_seq', 'chr_9_pos_meta', 'chr_9_pos_out', 'chr_9_pos_seq', 'chr_X_neg_(1000, 5000)_meta', 'chr_X_neg_(1000, 5000)_seq', 'chr_X_neg_(10000, 20000)_meta', 'chr_X_neg_(10000, 20000)_seq', 'chr_X_neg_(20000, 100000)_meta', 'chr_X_neg_(20000, 100000)_seq', 'chr_X_neg_(5000, 10000)_meta', 'chr_X_neg_(5000, 10000)_seq', 'chr_X_pos_meta', 'chr_X_pos_out', 'chr_X_pos_seq', 'chr_Y_neg_(1000, 5000)_meta', 'chr_Y_neg_(1000, 5000)_seq', 'chr_Y_neg_(10000, 20000)_meta', 'chr_Y_neg_(10000, 20000)_seq', 'chr_Y_neg_(20000, 100000)_meta', 'chr_Y_neg_(20000, 100000)_seq', 'chr_Y_neg_(5000, 10000)_meta', 'chr_Y_neg_(5000, 10000)_seq', 'chr_Y_pos_meta', 'chr_Y_pos_out', 'chr_Y_pos_seq']
Dataset Metadata:
{'chroms': ['chr_1', 'chr_10', 'chr_11', 'chr_12', 'chr_13', 'chr_14', 'chr_15', 'chr_16', 'chr_17', 'chr_18', 'chr_19', 'chr_2', 'chr_20', 'chr_21', 'chr_22', 'chr_3', 'chr_4', 'chr_5', 'chr_6', 'chr_7', 'chr_8', 'chr_9', 'chr_X', 'chr_Y'], 'dataset_params': {'type': 'by_chrom', 'random_seed': None, 'date': '2022-10-18 17:53:34.871940'}, 'names_suffix': {'positive_dataset': '_pos_', 'negative_dataset': '_neg_', 'model_input': '_seq', 'model_output': '_out', 'chrom_extra_info': '_meta'}, 'num_2_base_dict': {'0': 'A', '1': 'C', '2': 'T', '3': 'G', '4': 'R'}, 'encoding_dict': {'A': 0, 'C': 1, 'T': 2, 'G': 3, 'N': 4, 'M': 4, 'R': 4}, 'num_reverse_compliment_dict': {'0': 2, '2': 0, '1': 3, '3': 1, '4': 4}, 'positive_metadata_cols': ['start', 'end', 'seq_midpoint', 'original_A', 'original_C', 'original_T', 'original_G', 'example_A', 'example_C', 'example_T', 'example_G', 'AA1_hotspots'], 'negative_metadata_cols': ['start', 'end', 'seq_midpoint', 'original_A', 'original_C', 'original_T', 'original_G', 'example_A', 'example_C', 'example_T', 'example_G'], 'binarize_output': True, 'negative_sampling_intervals': [[1000, 5000], [5000, 10000], [10000, 20000], [20000, 100000]], 'chroms_lens': {'chr_1': 249250621, 'chr_2': 243199373, 'chr_3': 198022430, 'chr_4': 191154276, 'chr_5': 180915260, 'chr_6': 171115067, 'chr_7': 159138663, 'chr_8': 146364022, 'chr_9': 141213431, 'chr_10': 135534747, 'chr_11': 135006516, 'chr_12': 133851895, 'chr_13': 115169878, 'chr_14': 107349540, 'chr_15': 102531392, 'chr_16': 90354753, 'chr_17': 81195210, 'chr_18': 78077248, 'chr_19': 59128983, 'chr_20': 63025520, 'chr_21': 48129895, 'chr_22': 51304566, 'chr_X': 155270560, 'chr_Y': 59373566, 'chr_MT': 16569}, 'test_set_size': 0.1, 'random_seed': 123}
Renamed Negative Examples:
{(1000, 5000): 1.0}
Expanding output out into its individual columns ['AA1_hotspots']
GETTING META chr_1_pos_meta
3692 1926.0
GETTING META chr_1_neg_(1000, 5000)_meta
3852 Training examples generated for chrom 1
	1926 positive, 1926 negative
GETTING META chr_2_pos_meta
3741 1951.0
GETTING META chr_2_neg_(1000, 5000)_meta
3902 Training examples generated for chrom 2
	1951 positive, 1951 negative
GETTING META chr_3_pos_meta
2865 1500.0
GETTING META chr_3_neg_(1000, 5000)_meta
3000 Training examples generated for chrom 3
	1500 positive, 1500 negative
GETTING META chr_4_pos_meta
3008 1577.0
GETTING META chr_4_neg_(1000, 5000)_meta
3154 Training examples generated for chrom 4
	1577 positive, 1577 negative
GETTING META chr_5_pos_meta
2702 1423.0
GETTING META chr_5_neg_(1000, 5000)_meta
2846 Training examples generated for chrom 5
	1423 positive, 1423 negative
GETTING META chr_6_pos_meta
2595 1363.0
GETTING META chr_6_neg_(1000, 5000)_meta
2726 Training examples generated for chrom 6
	1363 positive, 1363 negative
GETTING META chr_7_pos_meta
2310 1210.0
GETTING META chr_7_neg_(1000, 5000)_meta
2420 Training examples generated for chrom 7
	1210 positive, 1210 negative
GETTING META chr_8_pos_meta
2120 1120.0
GETTING META chr_8_neg_(1000, 5000)_meta
2240 Training examples generated for chrom 8
	1120 positive, 1120 negative
GETTING META chr_9_pos_meta
1818 963.0
GETTING META chr_9_neg_(1000, 5000)_meta
1926 Training examples generated for chrom 9
	963 positive, 963 negative
GETTING META chr_10_pos_meta
1865 985.0
GETTING META chr_10_neg_(1000, 5000)_meta
1970 Training examples generated for chrom 10
	985 positive, 985 negative
GETTING META chr_11_pos_meta
1704 918.0
GETTING META chr_11_neg_(1000, 5000)_meta
1836 Training examples generated for chrom 11
	918 positive, 918 negative
GETTING META chr_12_pos_meta
1829 981.0
GETTING META chr_12_neg_(1000, 5000)_meta
1962 Training examples generated for chrom 12
	981 positive, 981 negative
GETTING META chr_13_pos_meta
1747 910.0
GETTING META chr_13_neg_(1000, 5000)_meta
1820 Training examples generated for chrom 13
	910 positive, 910 negative
GETTING META chr_14_pos_meta
1733 908.0
GETTING META chr_14_neg_(1000, 5000)_meta
1816 Training examples generated for chrom 14
	908 positive, 908 negative
GETTING META chr_15_pos_meta
1436 759.0
GETTING META chr_15_neg_(1000, 5000)_meta
1518 Training examples generated for chrom 15
	759 positive, 759 negative
GETTING META chr_16_pos_meta
1215 651.0
GETTING META chr_16_neg_(1000, 5000)_meta
1302 Training examples generated for chrom 16
	651 positive, 651 negative
GETTING META chr_17_pos_meta
1076 576.0
GETTING META chr_17_neg_(1000, 5000)_meta
1152 Training examples generated for chrom 17
	576 positive, 576 negative
GETTING META chr_18_pos_meta
1236 664.0
GETTING META chr_18_neg_(1000, 5000)_meta
1328 Training examples generated for chrom 18
	664 positive, 664 negative
GETTING META chr_19_pos_meta
904 479.0
GETTING META chr_19_neg_(1000, 5000)_meta
958 Training examples generated for chrom 19
	479 positive, 479 negative
GETTING META chr_20_pos_meta
835 449.0
GETTING META chr_20_neg_(1000, 5000)_meta
898 Training examples generated for chrom 20
	449 positive, 449 negative
GETTING META chr_21_pos_meta
821 450.0
GETTING META chr_21_neg_(1000, 5000)_meta
900 Training examples generated for chrom 21
	450 positive, 450 negative
GETTING META chr_22_pos_meta
793 430.0
GETTING META chr_22_neg_(1000, 5000)_meta
860 Training examples generated for chrom 22
	430 positive, 430 negative
There are 39940 examples in the dataset
dict_keys(['chrom_idx', 'index', 'ex_type', 'ds_index'])
AA1_hotspots ['AA1_hotspots']
Epoch 1/10
209/209 [==============================] - 21s 88ms/step - loss: 0.6091 - accuracy: 0.6717 - auc: 0.7259 - precision: 0.7089 - precision_m: 0.7223 - recall: 0.5782 - recall_m: 0.5811 - f1_m: 0.6378 - val_loss: 0.5414 - val_accuracy: 0.7062 - val_auc: 0.7844 - val_precision: 0.9547 - val_precision_m: 0.9446 - val_recall: 0.4372 - val_recall_m: 0.4331 - val_f1_m: 0.5914
Epoch 2/10
209/209 [==============================] - 18s 85ms/step - loss: 0.5176 - accuracy: 0.7279 - auc: 0.7966 - precision: 0.8010 - precision_m: 0.8048 - recall: 0.6035 - recall_m: 0.6046 - f1_m: 0.6872 - val_loss: 0.5188 - val_accuracy: 0.7323 - val_auc: 0.8391 - val_precision: 0.9356 - val_precision_m: 0.9254 - val_recall: 0.5030 - val_recall_m: 0.4980 - val_f1_m: 0.6455
Epoch 3/10
209/209 [==============================] - 13s 60ms/step - loss: 0.4332 - accuracy: 0.7933 - auc: 0.8725 - precision: 0.8292 - precision_m: 0.8309 - recall: 0.7368 - recall_m: 0.7397 - f1_m: 0.7803 - val_loss: 0.7510 - val_accuracy: 0.7744 - val_auc: 0.9007 - val_precision: 0.9771 - val_precision_m: 0.9676 - val_recall: 0.5652 - val_recall_m: 0.5589 - val_f1_m: 0.7064
Epoch 4/10
208/209 [============================>.] - ETA: 0s - loss: 0.3598 - accuracy: 0.8450 - auc: 0.9147 - precision: 0.8719 - precision_m: 0.8728 - recall: 0.8073 - recall_m: 0.8102 - f1_m: 0.8387
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best)... Done. 0.1s
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best/assets
wandb: Adding directory to artifact (/lustre06/project/6065672/otastet1/projects/prdm9_chipseq/recode/train/wandb/offline-run-20221111_123420-bxarkj27/files/model-best)... Done. 0.1s
209/209 [==============================] - 17s 82ms/step - loss: 0.3594 - accuracy: 0.8452 - auc: 0.9149 - precision: 0.8721 - precision_m: 0.8730 - recall: 0.8075 - recall_m: 0.8105 - f1_m: 0.8389 - val_loss: 0.4478 - val_accuracy: 0.8294 - val_auc: 0.9229 - val_precision: 0.9640 - val_precision_m: 0.9548 - val_recall: 0.6869 - val_recall_m: 0.6790 - val_f1_m: 0.7917
Epoch 5/10
209/209 [==============================] - 17s 84ms/step - loss: 0.3386 - accuracy: 0.8579 - auc: 0.9254 - precision: 0.8773 - precision_m: 0.8782 - recall: 0.8309 - recall_m: 0.8335 - f1_m: 0.8538 - val_loss: 0.3122 - val_accuracy: 0.8704 - val_auc: 0.9400 - val_precision: 0.9223 - val_precision_m: 0.9129 - val_recall: 0.8109 - val_recall_m: 0.8026 - val_f1_m: 0.8531
Epoch 6/10
209/209 [==============================] - 13s 61ms/step - loss: 0.3241 - accuracy: 0.8646 - auc: 0.9317 - precision: 0.8856 - precision_m: 0.8863 - recall: 0.8361 - recall_m: 0.8385 - f1_m: 0.8602 - val_loss: 0.4468 - val_accuracy: 0.8317 - val_auc: 0.9329 - val_precision: 0.9739 - val_precision_m: 0.9642 - val_recall: 0.6841 - val_recall_m: 0.6765 - val_f1_m: 0.7936
Epoch 7/10
209/209 [==============================] - 17s 82ms/step - loss: 0.3165 - accuracy: 0.8674 - auc: 0.9359 - precision: 0.8880 - precision_m: 0.8886 - recall: 0.8396 - recall_m: 0.8419 - f1_m: 0.8631 - val_loss: 0.2948 - val_accuracy: 0.8788 - val_auc: 0.9441 - val_precision: 0.8896 - val_precision_m: 0.8805 - val_recall: 0.8669 - val_recall_m: 0.8584 - val_f1_m: 0.8684
Epoch 8/10
209/209 [==============================] - 12s 58ms/step - loss: 0.3096 - accuracy: 0.8711 - auc: 0.9377 - precision: 0.8894 - precision_m: 0.8905 - recall: 0.8466 - recall_m: 0.8487 - f1_m: 0.8675 - val_loss: 0.3163 - val_accuracy: 0.8659 - val_auc: 0.9442 - val_precision: 0.9539 - val_precision_m: 0.9444 - val_recall: 0.7710 - val_recall_m: 0.7632 - val_f1_m: 0.8430
Epoch 9/10
209/209 [==============================] - 12s 59ms/step - loss: 0.3065 - accuracy: 0.8742 - auc: 0.9397 - precision: 0.8948 - precision_m: 0.8956 - recall: 0.8469 - recall_m: 0.8489 - f1_m: 0.8702 - val_loss: 0.3624 - val_accuracy: 0.8598 - val_auc: 0.9445 - val_precision: 0.9549 - val_precision_m: 0.9456 - val_recall: 0.7573 - val_recall_m: 0.7492 - val_f1_m: 0.8349
Epoch 10/10
209/209 [==============================] - 12s 59ms/step - loss: 0.2994 - accuracy: 0.8752 - auc: 0.9421 - precision: 0.8960 - precision_m: 0.8968 - recall: 0.8478 - recall_m: 0.8502 - f1_m: 0.8715 - val_loss: 0.3335 - val_accuracy: 0.8702 - val_auc: 0.9459 - val_precision: 0.8483 - val_precision_m: 0.8397 - val_recall: 0.9039 - val_recall_m: 0.8951 - val_f1_m: 0.8655
209/209 [==============================] - 17s 82ms/step - loss: 0.3594 - accuracy: 0.8452 - auc: 0.9149 - precision: 0.8721 - precision_m: 0.8730 - recall: 0.8075 - recall_m: 0.8105 - f1_m: 0.8389 - val_loss: 0.4478 - val_accuracy: 0.8294 - val_auc: 0.9229 - val_precision: 0.9640 - val_precision_m: 0.9548 - val_recall: 0.6869 - val_recall_m: 0.6790 - val_f1_m: 0.7917